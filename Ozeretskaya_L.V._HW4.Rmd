---
title: "BioHW4"
author: "Ozeretskaya L.V."
date: "2024-04-03"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Задание 1 (2 балла)
Рассмотрите следующую статистическую гипотезу.

Проводят некоторое исследование пациентов с артериальной гипертензией. Предположим, что внедрение нового препарата в среднем лучше снижает их давление по сравнению со стандартной терапией.

Задайте seed для воспроизводимости результатов (функция set.seed()). Задайте размер выборки sample_size <- 30. Задайте значение среднего артериального давления до приема нового препарата и после.
```{r}
set.seed(123)
sample_size <- 30
AP_mean_before <- 160
AP_mean_after <- 130

Data_AD_before <- rnorm(n = sample_size, AP_mean_before)
Data_AD_before
Data_AD_after <- rnorm(n = sample_size, AP_mean_after)
Data_AD_after
```



Затем:

Сформулируйте нулевую и альтернативную гипотезы.

- Нулевая гипотеза(H0) - средние АД до приема нового препарата не отличается от среднего АД после приема нового препарата
- Альтернативная гипотеза(H1) - средние АД до приема нового препарата отличается от среднего АД после приема нового препарата

Определите уровень значимости.

```{r}
# Уровень значимости (alpha):
alpha <- 0.05
```

Выберите статистический тест для проверки гипотезы и аргументируйте свой выбор.
```{r}
# Проверим данные на нормальность распределения:
hist(Data_AD_before,
     breaks = 7)

shapiro.test(Data_AD_before)

hist(Data_AD_after,
     breaks = 7)

shapiro.test(Data_AD_before)
```

```{r}
# Учитывая нормальное распределение данных, я выбрала т-тест для зависимых выборок, так как выборки связаны между собой("до и после")
t.test(Data_AD_before, Data_AD_after, paired = TRUE)
```

Определите наблюдаемое значение статистики, а также критическое значение статистики.

- наблюдаемое значение статистики: t = 116.35
- критическое значение статистики: (пока не очень поняла, как его определить)

Оцените и прокомментируйте статистическую значимость.
- p-value < 2.2e-16, учитывая очень маленькое р-value, можно отвергнуть нулевую гипотезу и принять альтернативную. Таким образом средние АД до приема нового препарата отличается от среднего АД после приема нового препарата.


## Задание 2 (2 балла)
Рассмотрите следующую статистическую гипотезу.

Существует некоторая связь между курением и развитием рака легких. Пусть у курящих людей вероятность заболеть раком легких составляет 0.8, а у некурящих — 0.2

Рассмотрите два случая: для выборки sample_size1 <- 100 и выборки sample_size2 <- 30. Сгенерируйте данные по курению с помощью функции rep(), пусть отношение числа курящих к некурящим в каждой выборке составляет 1:1.

```{r}
sample_size1 <- 100
sample_size2 <- 30

# Для выборки sample_size1 <- 100
smokers_size1 <- rep(1, sample_size1 / 2)
n_smokers_size1 <- rep(0, sample_size1 / 2)

table1_1 <- data.frame(
  group = smokers_size1,
  canser = rep(c("yes", "no"), times = c(80, 20))
)

table1_2 <- data.frame(
  group = n_smokers_size1,
  canser = rep(c("yes", "no"), times = c(20, 80))
)

table_res1 <- rbind(table1_1, table1_2)

table_con_1 <- table(table_res1$group, table_res1$canser)

```



```{r}
table_con_1
```
Затем:

Сформулируйте нулевую и альтернативную гипотезы.

- Нулевая гипотеза(Н0) - заболеваемость раком легких в двух выборках(курящие и не куряшие) одинакова
- Альтернативеая гипотеза(Н1) - заболеваемость раком легких в двух выборках(курящие и не куряшие) различна

Определите уровень значимости.
- $ \alpha = 0.05 $
Выберите статистический тест для проверки гипотезы и аргументируйте свой выбор.


```{r}
# Я выбрала критерий Хи-квадрат так как объем выборки достаточно большой
chisq.test(table_con_1)
```
Определите наблюдаемое значение статистики, а также критическое значение статистики.
- Наблюдаемое значение статистики: X-squared = 69.62
Оцените и прокомментируйте статистическую значимость.
- p-value < 2.2e-16, p-value < $ \alpha $, таким образом различие между выборками статистически значимо.

Далее:
```{r}
# Для выборки sample_size2 <- 30
smokers_size2 <- rep(1, sample_size2 / 2)
n_smokers_size2 <- rep(0, sample_size2 / 2)

table2_1 <- data.frame(
  group = smokers_size2,
  canser = rep(c("yes", "no"), times = c(24, 6))
)

table2_2 <- data.frame(
  group = n_smokers_size2,
  canser = rep(c("yes", "no"), times = c(6, 24))
)

table_res2 <- rbind(table2_1, table2_2)

table_con_2 <- table(table_res2$group, table_res2$canser)
```

```{r}
table_con_2
```
Сформулируйте нулевую и альтернативную гипотезы.

- Нулевая гипотеза(Н0) - заболеваемость раком легких в двух выборках(курящие и не куряшие) одинакова
- Альтернативеая гипотеза(Н1) - заболеваемость раком легких в двух выборках(курящие и не куряшие) различна

Определите уровень значимости.
- $ \alpha = 0.05 $
Выберите статистический тест для проверки гипотезы и аргументируйте свой выбор.
```{r}
# я выбрала точный критерий Фишера, так как объем выборки небольшой
fisher.test(table_con_2)
```
Определите наблюдаемое значение статистики, а также критическое значение статистики.
- Наблюдаемое значение статистики: 15.03569
Оцените и прокомментируйте статистическую значимость.
- p-value = 6.319e-06, p-value < $ \alpha $, таким образом различие между выборками статистически значимо.


## Задание 3 (3 балла)
Рассмотрите следующую статистическую гипотезу.

Применение нового метода лечения синдрома раздраженного кишечника значимо меняет уровень болевых симптомов по сравнению с группой, прошедшей лечение диетотерапией.
```{r}
Data_diet <- rnorm(n = 100, 7)
Data_new <- rnorm(n = 100, 5)
```


Исследователь избегает любых допущений, кроме того, что выборки независимы и имеют одинаковое распределение.

Что нужно сделать:

Сформулируйте нулевую и альтернативную гипотезы.

- Нулевая гипотеза(Н0) - уровень болевых симптомов одинаков в обеих выборках
- Альтернативная гипотеза(Н1) - уровень болевых симптомов в выборках различается 

Определите уровень значимости.
- $ \alpha = 0.05 $
Выберите статистический тест для проверки гипотезы и аргументируйте свой выбор.
```{r}
# Я выбрала тест Манна-Уитни так как по условию задачи мы не делаем предположение о форме распределения, а значит стоит использовать непараметрический критерий
Data_test <- wilcox.test(Data_new, Data_diet, alternative = "two.sided")
Data_test
```

Определите наблюдаемое значение статистики, а также критическое значение статистики.
- Наблюдаемое значение статистики: W = 771
Оцените и прокомментируйте статистическую значимость.
p-value очень маленький (< 2.2e-16), меньше уровня значимости (0.05), в связи с чем мы откланяем нулевую гипотезу и принечаем анльтернативную. Различия между выборками статистически значимы.

## Задание 4 (4 балла)
Рассмотрите следующую гипотезу.

Проводится исследование, в котором исследуются три противоопухолевые препарата A, B плацебо (0) на трех группах мышей. В каждой из трех групп по 10 мышей.  Оценивается размер опухоли у мыши.

Сгенерируйте датасет следующим образом:
```{r}
tumor <- tibble(
  therapy = c(rep("0", 10), rep("A", 10), rep("B", 10)),
  value = c(rep(3213, 10), rep(2687, 10), rep(2423, 10))
) %>%
  mutate(therapy = factor(therapy, levels = c("0", "A", "B")))
tumor$value <- tumor$value + rnorm(30, 0, 760)
```


Постройте на одном графике три «ящика с усами» для наглядности.
```{r}
ggplot(tumor, aes(x = therapy, y = value, fill = therapy)) +
  geom_boxplot() +
  theme_bw()
```
```{r}
# Проверим нормальность распределения
shapiro.test(tumor$value)
```
- Данные распределены нормально

```{r}
DescTools::LeveneTest(value ~ therapy, data = tumor)
```
- данные распределены гомоскедастично

Проведите дисперсионный анализ, чтобы выяснить, есть ли разница между размером опухоли во всех группах. 

```{r}
a_tumor <- aov(value ~ therapy, data = tumor)
summary(a_tumor)
```
Прокомментируйте получившийся результат.

- p-value = 0.0131 ниже уровня значимости 0.05, что позволяет нам отвергнуть нулевую гипотезу о том , что средние во всех трех выборках равны, но не позволяет определить между какими выборками есть разница, для этого мы воспользуемся попарным сравнением.

С помощью функции TukeyHSD() проведите попарные сравнения, используя критерий Тьюки.
```{r}
tukey_tumor = TukeyHSD(a_tumor)
tukey_tumor
```

Прокомментируйте полученные результаты.
- По результатам попарного сравнения мы определили только один значемый p-value = 0.0121131 при сравнении группы препарата А с плацебо(0), таким образом статистически значимая разница по сравнению с плацебо есть при терапии проводимой только одним из двух препаратов(препарат А)
